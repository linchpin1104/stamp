(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5471],{49901:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>x});var n=i(95155),r=i(12115),s=i(35695),a=i(6874),o=i.n(a),c=i(41855),d=i(30285),l=i(66695),u=i(12543),m=i(87481),p=i(25711);let h=e=>"".concat(e,"-").concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,7)),w=e=>{let t=h("le-stub-".concat(e)),i=h("content-stub-".concat(e));switch(e){case"video":return{id:t,type:e,content:{id:i,title:"New Video (Edit Later)",url:""}};case"video_choice_group":return{id:t,type:e,content:{id:i,title:"New Video Choice Group (Edit Later)",videos:[],selectionRule:"choose_one"}};case"checklist":return{id:t,type:e,content:{id:i,title:"New Checklist (Edit Later)",items:[],type:"generic_todo"}};case"action_item":return{id:t,type:e,content:{id:i,title:"New Action Item (Edit Later)",description:"",type:"todo_list",todoItems:[]}};case"interactive_scenario_link":return{id:t,type:e,scenarioId:"",title:"New Interactive Scenario (Link Later)"};case"text_content":return{id:t,type:e,content:{id:i,title:"New Text Content (Edit Later)",type:"article",content:""}};case"psychological_test":return{id:t,type:e,content:{id:i,title:"New Psychological Test (Edit Later)",factors:[],overallResultComments:[]}};case"qa_session":return{id:t,type:e,content:{id:i,title:"New Q&A Session (Edit Later)",prompts:[]}};case"mission_reminder":return{id:t,type:e,content:{id:i,title:"New Mission Reminder (Edit Later)",missionTitle:"",missionDescription:""}};case"ox_quiz":return{id:t,type:e,content:{id:i,title:"New O/X Quiz (Edit Later)",questions:[]}};default:return{id:t,type:"text_content",content:{id:i,title:"New Content (Edit Later)",type:"article",content:""}}}};function x(){let e=(0,s.useRouter)(),{programId:t}=(0,s.useParams)(),{toast:i}=(0,m.dj)(),[a,x]=(0,r.useState)(null),[g,k]=(0,r.useState)(null),[N,f]=(0,r.useState)(!0);(0,r.useEffect)(()=>{"string"==typeof t?x(t):x(null)},[t]),(0,r.useEffect)(()=>{a?(async()=>{f(!0);let t=await (0,p.HD)(a);t?k(t):(i({title:"Error",description:"Program not found to add week to.",variant:"destructive"}),e.push("/admin/programs")),f(!1)})():null===t&&f(!1)},[a,e,i,t]);let E=async t=>{if(!g||!g.id){i({title:"Error",description:"Program data is missing.",variant:"destructive"});return}let n=(t.initialLearningElementTypes||[]).map(e=>w(e)),r={id:h("week"),weekNumber:t.weekNumber,title:t.title,summary:t.summary,sequentialCompletionRequired:t.sequentialCompletionRequired||!1,learningElements:n},s=[...g.weeks||[],r].sort((e,t)=>e.weekNumber-t.weekNumber);await (0,p.El)(g.id,{weeks:s})?(i({title:"Week Added",description:"Week ".concat(r.weekNumber,': "').concat(r.title,'" added to ').concat(g.title,". Placeholder content elements created.")}),e.push("/admin/programs/".concat(g.id,"/edit"))):i({title:"Error",description:"Failed to add week to the program.",variant:"destructive"})};if(N)return(0,n.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,n.jsx)("p",{children:"Loading program data..."})});if(!g)return(0,n.jsxs)("div",{className:"text-center py-10",children:["Program not found. ",(0,n.jsx)(o(),{href:"/admin/programs",className:"text-accent underline",children:"Go back"}),"."]});let v=g.weeks&&g.weeks.length>0?Math.max(...g.weeks.map(e=>e.weekNumber)):0;return(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)("div",{className:"flex items-center justify-start",children:(0,n.jsx)(d.$,{variant:"outline",size:"sm",asChild:!0,children:(0,n.jsxs)(o(),{href:a?"/admin/programs/".concat(a,"/edit"):"/admin/programs",children:[(0,n.jsx)(u.A,{className:"mr-2 h-4 w-4"}),"Back to Program Management"]})})}),(0,n.jsxs)(l.Zp,{className:"max-w-2xl mx-auto shadow-lg",children:[(0,n.jsxs)(l.aR,{children:[(0,n.jsxs)(l.ZB,{className:"text-2xl text-primary",children:['Add New Week to "',g.title,'"']}),(0,n.jsx)(l.BT,{children:"Define the basic details and select initial content types for this new week. Detailed content will be added using the content builder."})]}),(0,n.jsx)(l.Wu,{children:(0,n.jsx)(c.j,{onSubmit:E,programMaxWeeks:v,isEditing:!1})})]})]})}},99953:(e,t,i)=>{Promise.resolve().then(i.bind(i,49901))}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,9855,5769,6874,1509,1174,5521,2567,5916,9127,1855,8441,1684,7358],()=>t(99953)),_N_E=e.O()}]);