(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5159],{48103:(e,s,t)=>{Promise.resolve().then(t.bind(t,93309))},85057:(e,s,t)=>{"use strict";t.d(s,{J:()=>c});var r=t(95155),a=t(12115),n=t(40968),l=t(74466),i=t(59434);let o=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(n.b,{ref:s,className:(0,i.cn)(o(),t),...a})});c.displayName=n.b.displayName},88539:(e,s,t)=>{"use strict";t.d(s,{T:()=>l});var r=t(95155),a=t(12115),n=t(59434);let l=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...a})});l.displayName="Textarea"},93309:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>g});var r=t(95155),a=t(12115),n=t(35695),l=t(6874),i=t.n(l),o=t(30285),c=t(66695),d=t(88539),u=t(85057),m=t(12543),p=t(67270),f=t(8376),x=t(25711),h=t(87481),v=t(39022);function g(){let{slug:e,weekId:s,qaSessionId:t}=(0,n.useParams)(),l=(0,n.useRouter)(),{toast:g}=(0,h.dj)(),[b,w]=(0,a.useState)(null),[j,N]=(0,a.useState)(null),[S,y]=(0,a.useState)(null),[k,E]=(0,a.useState)(null),[R,_]=(0,a.useState)(null),[q,A]=(0,a.useState)(null),[C,P]=(0,a.useState)(!0),[I,T]=(0,a.useState)({}),[W,B]=(0,a.useState)(null),[F,J]=(0,a.useState)(!1);(0,a.useEffect)(()=>{"string"==typeof e?w(e):w(null)},[e]),(0,a.useEffect)(()=>{"string"==typeof s?N(s):N(null)},[s]),(0,a.useEffect)(()=>{"string"==typeof t?y(t):y(null)},[t]),(0,a.useEffect)(()=>{let e=localStorage.getItem("userProfile");if(e)try{B(JSON.parse(e))}catch(e){console.error("Failed to parse userProfile from localStorage",e),B(v._o)}else B(v._o)},[]),(0,a.useEffect)(()=>{let r=async()=>{if(!b||!j||!S||!W){P(!1);return}P(!0);let e=await (0,x.Z5)(b);if(e){var s,t;E(e);let r=null===(s=e.weeks)||void 0===s?void 0:s.find(e=>e.id===j);if(r){_(r);let e=null===(t=r.learningElements)||void 0===t?void 0:t.find(e=>"qa_session"===e.type&&e.id===S);if(e&&"qa_session"===e.type){if(A(e.content),(null==W?void 0:W.qaSessionResponses)&&W.qaSessionResponses[e.content.id]){let s={};W.qaSessionResponses[e.content.id].forEach(e=>{s[e.promptId]=e.answer}),T(s),e.content.prompts.every(e=>{var t;return null===(t=s[e.id])||void 0===t?void 0:t.trim()})&&J(!0)}}else g({title:"Error",description:"Q&A Session not found in this week.",variant:"destructive"}),A(null)}else g({title:"Error",description:"Week not found.",variant:"destructive"}),_(null)}else g({title:"Error",description:"Program not found.",variant:"destructive"}),E(null);P(!1)};W&&b&&j&&S?r():(null===e||null===s||null===t)&&P(!1)},[b,j,S,g,W,e,s,t]);let O=(e,s)=>{T(t=>({...t,[e]:s})),J(!1)};return C||!W?(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)("p",{children:"Loading Q&A session..."})}):q&&k&&R?(0,r.jsxs)("div",{className:"space-y-6 max-w-3xl mx-auto",children:[(0,r.jsx)(o.$,{variant:"outline",size:"sm",asChild:!0,children:(0,r.jsxs)(i(),{href:b&&j?"/programs/".concat(b,"/week/").concat(j):b?"/programs/".concat(b):"/programs",children:[(0,r.jsx)(m.A,{className:"mr-2 h-4 w-4"})," Back to Week Content"]})}),(0,r.jsxs)(c.Zp,{className:"shadow-xl",children:[(0,r.jsx)(c.aR,{children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)(p.A,{className:"h-8 w-8 text-primary"}),(0,r.jsxs)("div",{children:[(0,r.jsx)(c.ZB,{className:"text-2xl text-primary",children:q.title}),q.description&&(0,r.jsx)(c.BT,{children:q.description})]})]})}),(0,r.jsx)(c.Wu,{className:"space-y-6",children:q.prompts.map((e,s)=>(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(u.J,{htmlFor:"prompt-".concat(e.id),className:"text-base font-medium text-foreground/90",children:[s+1,". ",e.question]}),(0,r.jsx)(d.T,{id:"prompt-".concat(e.id),value:I[e.id]||"",onChange:s=>O(e.id,s.target.value),placeholder:e.answerPlaceholder||"Your answer...",rows:3,className:"bg-background focus:border-primary",disabled:F})]},e.id))}),(0,r.jsxs)(c.wL,{className:"flex flex-col sm:flex-row justify-end gap-2 pt-6 border-t",children:[F?(0,r.jsxs)("div",{className:"flex items-center text-green-600 font-semibold",children:[(0,r.jsx)(f.A,{className:"mr-2 h-5 w-5"})," Session Completed & Saved"]}):(0,r.jsx)(o.$,{onClick:()=>{if(!q||!W){g({title:"Error",description:"Session or user data missing.",variant:"destructive"});return}if(!q.prompts.every(e=>{var s;return null===(s=I[e.id])||void 0===s?void 0:s.trim()})&&!F){g({title:"Incomplete",description:"Please answer all prompts before submitting.",variant:"destructive"});return}let e=q.prompts.map(e=>({promptId:e.id,answer:I[e.id]||""})),s={...W,qaSessionResponses:{...W.qaSessionResponses||{},[q.id]:e}};localStorage.setItem("userProfile",JSON.stringify(s)),B(s),J(!0),g({title:"Session Responses Saved",description:"Your answers have been recorded."})},className:"w-full sm:w-auto bg-accent hover:bg-accent/90 text-accent-foreground",children:"Submit All Answers"}),(0,r.jsx)(o.$,{onClick:()=>l.push(b&&j?"/programs/".concat(b,"/week/").concat(j):b?"/programs/".concat(b):"/programs"),className:"w-full sm:w-auto",variant:"outline",children:"Return to Week"})]})]})]}):(0,r.jsxs)("div",{className:"text-center py-10",children:[(0,r.jsx)("h1",{className:"text-2xl font-semibold",children:"Q&A Session Not Found"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"The session you are looking for does not exist or could not be loaded."}),(0,r.jsx)(o.$,{asChild:!0,variant:"link",className:"mt-4",children:(0,r.jsxs)(i(),{href:b&&j?"/programs/".concat(b,"/week/").concat(j):b?"/programs/".concat(b):"/programs",children:[(0,r.jsx)(m.A,{className:"mr-2 h-4 w-4"})," Back to Program/Week"]})})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[2992,9855,5769,6874,1509,1174,974,5916,9127,8441,1684,7358],()=>s(48103)),_N_E=e.O()}]);